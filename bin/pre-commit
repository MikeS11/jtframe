#!/bin/bash

if [ -z "$JTFRAME" ]; then
	echo "Define JTFRAME before continueing"
	exit 1
fi

# Check that the submodules are clean before committing the main repository
cd $JTROOT
if git status --short | grep modules; then
	echo "Commit or clean the submodules before committing"
	exit 1
fi

if ( git status -b -s -u no | grep behind > /dev/null ); then
	echo "Your work tree is behind the remote branch"
	echo "Pull your work before committing to avoid a merge"
	echo "or create a local branch to do the merge"
	exit 1
fi

exit 0

